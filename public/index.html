<!DOCTYPE html>
<html>
	<head>
		<title>Petja Touru</title>
		<meta charset="UTF-8" />
		<link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet" />
		<meta content="width=device-width,initial-scale=1" name="viewport" />
		<style media="screen">
			html, body{
				margin: 0;
				padding: 0;
				height: 100%;
			}
			body{
				overflow-x: hidden;
				font-size: 1.1em;
				font-family: 'Roboto Mono', monospace;
				cursor: default;
			}
			#backdrop{
				position: fixed;
				top: 0;
				left: 0;
				height: 100%;
				width: 100%;
				background: #000;
				z-index: 16;
				opacity: 0;
				pointer-events: none;
				transition: 0.4s;
			}
			#backdrop.opened{
				opacity: 0.8;
			}
			#contact-menu{
				position: fixed;
				right: 0;
				bottom: 0;
				height: 100%;
				width: 100%;
				max-width: 25em;
				background: #0000FF;
				color: #FFF;
				background-size: cover;
				background-position: center center;
				transition: all 0.4s linear;
				z-index: 17;
				clip-path: circle(0% at calc(100% - 4em) calc(100% - 4em));
				display: flex;
				text-align: center;
				align-items: center;
				flex-wrap: wrap;
			}
			#contact-menu div {
				width: 100%;
			}
			#contact-menu.opened{
				clip-path: circle(120vmax at calc(100% - 4em) calc(100% - 4em));
			}
			#fab{
				position: fixed;
				bottom: 2em;
				right: 2em;
				height: 4em;
				width: 4em;
				color: #FFF;
				border-radius: 50%;
				z-index: 18;
				background: #00E676;
				box-shadow: 0 2px 2px rgba(0, 0, 0, 0.5);
				display: flex;
				align-items: center;
				transition: 0.3333s;
			}
			#fab svg{
				width: 1.5em;
				height: 1.5em;
			}
			#fab-close-icon{
				display: none;
			}
			#fab.opened {
				background: #FFF;
				color: #000;
			}
			#fab svg{
				margin: 0 auto;
			}
			#foo{
				background-color: #fca0d4;
				color: #FFF;
				background-image: linear-gradient(rgba(0,0,0,0.25), rgba(0,0,0,0.25)), url("background.jpg"), linear-gradient(#fe80fe, #fac0aa);
				background-size: cover;
				background-position: center center;
				height: 100%;
				display: flex;
				align-items: center;
				flex-wrap: wrap;
				overflow: hidden;
			}
			#logo{
				background: url("petjalogo.svg");
				background-size: contain;
				background-position: center center;
				background-repeat: no-repeat;
				width: 600px;
				max-width: calc(100% - 64px);
				height: 128px;
				animation: logo_entrance;
				animation-duration: 2s;
				margin: 0 auto;
			}
			#scanlines,#screen{
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				pointer-events: none;
			}
			#screen{
				background: radial-gradient(ellipse, rgba(0,0,0,0) 0%, rgba(0,0,0,0) 50%, rgba(0,0,0,0.75) 100%);
				transition: 2s;
				z-index: 15;
			}
			#scanlines{
				z-index: 11;
				background-image: url("scanline.svg");
				/*background: linear-gradient(transparent 0%, rgba(0, 0, 0, 0.3333) 50%, transparent 100%);*/
				/* Native gradient doesn't work in Firefox for some reason. Using SVG. */
				background-size: 0.3em;
			}
			#scanlines.animated{
				animation: scanlines;
				animation-duration: 2s;
				animation-iteration-count: infinite;
				animation-timing-function: linear;
			}
			.delayed{
				animation: logo;
				animation-duration: 0.5s;
				transform: scale(0);
				animation-fill-mode: forwards;
			}
			#slogan, #social{
				color: inherit;
				text-transform: uppercase;
				font-weight: bold;
				max-width: 800px;
				margin: 0 auto;
			}
			#slogan {
				opacity: 0;
				animation: fade_full;
				animation-duration: 2s;
				animation-delay: 2s;
				animation-fill-mode: forwards;
				display: block;
				text-align: center;
				padding: 1em;
			}
			#social {
				display: flex;
				font-size: 1.5em;
				flex-wrap: wrap;
			}
			#social a {
				display: block;
				padding: 1em;
				color: inherit;
				text-decoration: none;
				flex: 1;
			}
			#my-picture {
				border-radius: 50%;
				width: 7.5em;
				box-shadow: 0 4px 4px rgba(0,0,0,0.5);
				display: block;
				margin: 0 auto;
			}
			#legal {
				font-size: 0.8em;
				opacity: 0;
				text-align: center;
				transition: 0.5s;
				color: #808080;
				animation: fade_half;
				animation-duration: 2s;
				animation-delay: 2s;
				animation-fill-mode: forwards;
				position: absolute;
				left: 0;
				bottom: 0;
				margin: 2em;
				z-index: 16;
			}
			#legal:hover{
				opacity: 1;
				color: #FFF;
			}
			.blink{
				background-image: url("blink.svg");
				height: 16px;
				width: 16px;
				background-size: cover;
				position: fixed;
				top: 128px;
				left: 128px;
				z-index: 9;
				pointer-events: none;
			}
			.blink.animated{
				animation: blink;
				animation-duration: 1s;
				animation-direction: alternate;
				animation-iteration-count: infinite;
				animation-timing-function: linear;
			}
			@keyframes fade_half {
				0% {
					opacity: 0;
				}
				100% {
					opacity: 0.5;
				}
			}
			@keyframes fade_full {
				0% {
					opacity: 0;
				}
				100% {
					opacity: 1;
				}
			}
			@keyframes logo_entrance {
				0% {
					transform: scale(0);
				}
				90% {
					transform: scale(1.1);
				}
				100% {
					transform: scale(1);
				}
			}
			@keyframes logo_bounce {
				0% {
					transform: scale(1);
				}
				50% {
					transform: scale(1.015);
				}
				100% {
					transform: scale(1);
				}
			}
			@keyframes blink {
				0% {
					transform: scale(0);
				}
				100% {
					transform: scale(1);
				}
			}
			@keyframes scanlines {
				0% {
					background-position: 0 0;
				}
				100% {
					background-position: 0 1.2em;
				}
			}
		</style>
		<script>
			var blinks = [];
			var blink_id = -1;
			var blink_count = 25;
			var blink_round = 2000;

			document.addEventListener("DOMContentLoaded", function() {
				//init_figure();
				go_to_page(0);

				setTimeout(function(){
					var logo = document.getElementById('logo');
					logo.style.animation = "logo_bounce 0.54s infinite";
				}, 3000);

				for(i=0; i<blink_count; i++){
					var blink = document.createElement("div");
					blink.className = "blink";
					blinks.push(blink);
					document.body.appendChild(blink);
				}

				setInterval(function(){
					blink_id = (blink_id + 1) % blink_count;
					var blink = blinks[blink_id];

					var logo_el = document.getElementById('logo');
					var blink_pos = {
						x : logo_el.offsetWidth * Math.random() + logo_el.offsetLeft,
						y : logo_el.offsetHeight * Math.random() + logo_el.offsetTop,
					};

					blink.className = "blink";
					blink.style.left = blink_pos.x + "px";
					blink.style.top = blink_pos.y + "px";
					blink.className = "blink animated";
				}, blink_round / blink_count);

				document.querySelector("#fab").addEventListener("click", function(e) {
					var contact_menu = document.querySelector("#contact-menu");
					var backdrop = document.querySelector("#backdrop");
					var scanlines = document.querySelector("#scanlines");
					var fab = document.querySelector("#fab");
					var close_icon = document.querySelector("#fab-close-icon");
					var message_icon = document.querySelector("#fab-message-icon");
					var bg_music = document.querySelector("#bg-music");

					if(contact_menu.className == "opened") {
						close_icon.style.display = "none";
						message_icon.style.display = "block";

						contact_menu.className = "closed";
						fab.className = "closed";

						setTimeout(function(){
							scanlines.style.display = "block";
							backdrop.className = "closed";
							bg_music.volume = 1;
						}, 400);
					} else {
						close_icon.style.display = "block";
						message_icon.style.display = "none";

						contact_menu.className = "opened";
						backdrop.className = "opened";
						fab.className = "opened";
						scanlines.style.display = "none";

						bg_music.volume = 0.2;
					}
				});
			});

			page = 0;

			setTimeout(function(){
				setInterval(function(){
					page++;
					for(var i = 0; i < 4; i++) slogan_flash(i);
				}, 2500);
			}, 1500);

			function slogan_flash(i) {
				slogan_element = document.querySelector('#slogan');
				setTimeout(function(){
					slogan_element.style.visibility = 'hidden';
					setTimeout(function(){
						slogan_element.style.visibility = 'visible';
					}, 75);
				}, i * 150);
			}

			setInterval(function(){
				go_to_page(page);
			}, 50);

			var slogans = [
				"Full Stack Software Developer",
				"BBA Student @ HAMK UAS",
				"Currenty living in Hämeenlinna, Finland",
				"Born " + age().toFixed(1) + " years ago",
				"Railroad fanatic",
			];

			function go_to_page(n){
				var slogan = document.querySelector('#slogan');
				slogan.innerText = slogans[n % slogans.length];
				/*switch(n){
					case 0:
						slogan.innerText = "Full Stack Software Developer";
						break;
					case 1:
						slogan.innerText = "BBA Student @ HAMK UAS";
						break;
					case 2:
						slogan.innerText = "Location: Hämeenlinna, Finland";
						break;
					case 3:
						slogan.innerText = "Age: " + age().toFixed(10) + " yrs";
						break;
					case 4:
						slogan.innerText = 'People call me "tech geek"';
						break;
					case 5:
						slogan.innerText = "Design matters";
						break;
				};*/
			}

			function age(){
				return (Date.now() - 854011020000) / 86400000 / 365.2425;
			}

			function init_figure() {
				c = document.getElementById("figurehead");
				ctx = c.getContext("2d");

				document.addEventListener("mousemove", function(e) {
					draw_figure(e.pageX, e.pageY);
				});

				figure_img = new Image;
				figure_img.src = 'pixelart.png';

				figure_img.onload = function(){
						draw_figure(0, 0);
				};
			}

			function draw_figure(mouseX, mouseY){
				// Clear canvas
				ctx.clearRect(0, 0, c.width, c.height);

				// Calculate rotation
				var canvas_position = c.getBoundingClientRect();
				var angle = get_angle_between_coordinates(mouseX, canvas_position.left + c.width / 2, mouseY, canvas_position.top + c.height / 2);

				// Draw!
				ctx.save();
				ctx.translate(c.width / 2, c.height / 2);
				if((angle + Math.PI) > 4.7124 || (angle + Math.PI) < 1.5708){
					ctx.scale(1, -1);
					ctx.rotate(-angle);
				}else{
					ctx.rotate(angle);
				}
				ctx.drawImage(figure_img, -48, -64, 96, 128);
				ctx.restore();
			}

			function get_angle_between_coordinates(x1, x2, y1, y2) {
				return Math.atan2(y2 - y1, x2 - x1);
			}
		</script>
	</head>
	<body>
		<div id="backdrop"></div>
		<div id="contact-menu">
			<div>
				<img src="https://gravatar.com/avatar/3fe5cfc5d9eaeea3d15c8b5605c93514?s=256" alt="Picture of Petja Touru" id="my-picture" />
			</div>
			<div id="social">
				<a href="https://linkedin.com/in/tourupetja">LinkedIn</a>
				<a href="https://twitter.com/petjato">Twitter</a>
				<a href="https://github.com/petja">Github</a>
				<a href="https://telegram.me/petjato">Telegram</a>
				<a href="mailto:hello@petja.me">Email</a>
			</div>
		</div>
		<div id="fab" class="closed">
			<svg id="fab-close-icon" viewBox="0 0 24 24"><path fill="rgba(0,0,0,0.6)" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
			<svg id="fab-message-icon" viewBox="0 0 24 24"><path fill="rgba(0,0,0,0.6)" d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z" /></svg>
		</div>
		<div id="foo">
			<div id="screen"></div>
			<div id="scanlines" class="animated"></div>
			<div id="legal">Website &copy; 2017 Petja Touru <!--Music: <em>Gray Is The Sky</em> by <em>Three Chain Links</em>. Music licensed with Creative Commons.--></div>
			<div style="width: 100%;text-align:center;">
				<div id="logo"></div>
				<div id="slogan"></div>
			</div>
		</div>
		<audio loop autoplay id="bg-music">
			<source src="snd/background.ogg" type="audio/ogg" />
		</audio>
	</body>
</html>
